---
title: "Assignment 3"
output: pdf_document
date: "2023-10-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r UniversalBank}

UniversalBank<- read.csv("C:\\Users\\13308\\OneDrive\\Documents\\UniversalBank.csv")
#A

library(e1071)
library(class)
library(caret)

UniversalBank$Online <- factor(UniversalBank$Online)
UniversalBank$CreditCard <- factor(UniversalBank$CreditCard)
UniversalBank$Personal.Loan <- factor(UniversalBank$Personal.Loan)

str(UniversalBank)

selected.var <- c(10, 13, 14)
train.index <- sample(c(1:dim(UniversalBank)[1]), dim(UniversalBank)[1]*0.6)
train.df <- UniversalBank[train.index, selected.var]
valid.df <- UniversalBank [-train.index, selected.var]

sum(is.na(train.df$CreditCard))
sum(is.na(train.df$Personal.Loan))

str(UniversalBank$Online)

pivot_table <- table(train.df$CreditCard, train.df$Personal.Loan, train.df$Online)
print(pivot_table)
combined_table <- addmargins(pivot_table)
print(combined_table)

#B

#I am calculating the number of Online=1/CC=1/PL=1, divded by the total number of Online=1/CC=1.
48 / 508

#C

LoanofOnline<- table(train.df$Personal.Loan, train.df$Online)
print(LoanofOnline)

LoanofCreditCard <- table(train.df$Personal.Loan, train.df$CreditCard)
print(LoanofCreditCard)

#Di

i <- (87 / (87 + 206))
print(i)

#Dii

ii<- (174 / (174 + 119))
print(ii)

#Diii

293 / 3000

#Div

784 / (784 + 1923)

#Dv

1606 / (1606 + 1101)

#Dvi

(3000 - 293) / 3000

#E


print(i*ii)

#F

#Overall, the value in (b) is more accurate as we are using the counts of customers that are 
#both CreditCard=1 and Online=1 to compute the probability of Loan = 1. The value 
#in (e) is using counts of customers that may be one but not the other.

#G

UniversalBank.nb <- naiveBayes(train.df$Personal.Loan ~ ., data = train.df)
UniversalBank.nb

#It would be the values in the bottom right of each pivot table, and the 
#product of both is the same value we received in (E).

```

